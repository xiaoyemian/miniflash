console.log("component/filterhtml is lost!"),define("component/dataURItoBlob",function(e,t){var n=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,o=window.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=o&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),r=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,a=(o||r)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(e){var t,n,a,l,s,d;for(t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),l=0;l<t.length;l+=1)a[l]=t.charCodeAt(l);return s=e.split(",")[0].split(":")[1].split(";")[0],o?new Blob([i?a:n],{type:s}):(d=new r,d.append(n),d.getBlob(s))};return window.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(e,t,o){e(o&&n.toDataURL&&a?a(this.toDataURL(t,o)):this.mozGetAsFile("blob",t))}:n.toDataURL&&a&&(n.toBlob=function(e,t,n){e(a(this.toDataURL(t,n)))})),a}),define("ui/uploadImg",function(e,t){var n=e("ui/sendAjaxPic");return function(e,t,o){var i=function(){var i=new FormData;i.append("attach",e),n(i,t,o)};t.onStart?t.onStart(i,o):i()}}),define("ui/sendAjaxPic",function(e,t){e("jquery");return function(e,t,n,o,i){var r,a=new XMLHttpRequest;new Date;a.onreadystatechange=function(){if(4==a.readyState){if(a.onreadystatechange=null,r&&window.clearTimeout(r),200!=a.status)return t.error&&t.error({description:"系统错误"},n,a.status,o,i);var e=!1;try{var l=JSON.parse(a.response)}catch(s){return e=!0,t.error&&t.error({description:s},n,l,o,i)}!e&&t.success&&t.success(l,n,o,i)}},t.progress&&a.upload.addEventListener("progress",function(e){t.progress(n,e.loaded/e.total,o,i)},!1),a.open("POST",t.behind),a.send(e),t.timeout&&(r=window.setTimeout(function(){t.error&&t.error({description:"上传失败超时"},n),a&&a.abort(),r&&window.clearTimeout(r)},t.timeout))}}),define("ui/pastePic",function(e,t){var n=e("component/filterhtml"),o=e("component/dataURItoBlob"),i=e("ui/uploadImg");t.bind=function(e){function t(t){if(t.clipboardData&&t.clipboardData.items){ele=t.clipboardData.items;for(var a=0;a<ele.length;++a)if("file"==ele[a].kind&&-1!==ele[a].type.indexOf("image/")){var l=ele[a].getAsFile();window.URL=window.URL||window.webkitURL;var s=window.URL.createObjectURL(l),d=$("<img/>",{src:s});r.append(d),i(ele[a].getAsFile(),e,d)}}else window.setTimeout(function(){for(var t=r.children("img"),n=0,a=t.length;a>n;n++){var l=$(t[n]),s=o(l.attr("src"));console.log(s),i(s,e,l)}},0);setTimeout(function(){r.html(n.filterRecieveHtml(r.html())).focus()},10)}var r=$(e.input);r[0].onpaste=t}});
